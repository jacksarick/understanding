<!doctype html>

<!-- ASSIGN OUR ANGULAR MODULE -->
<html ng-app="archive">
<head>
	<!-- META -->
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1"><!-- Optimize mobile viewport -->

	<title>Node/Angular Meme App</title>

	<!-- SCROLLS -->
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bulma/0.7.1/css/bulma.min.css"><!-- load bulma -->
	<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.1.0/css/all.css" integrity="sha384-lKuwvrZot6UHsBSfcMvOkWwlCMgc0TaWr+30HWe3a4ltaBwTZhyTEggF5tJv8tbt" crossorigin="anonymous"> <!-- font awesome -->
	<style>
		html 					{ overflow-y:scroll; }
		body 					{ padding-top:50px; }
		#meme-list 				{ margin-bottom:30px; }
		#meme-form 	 			{ margin-bottom:50px; }
	</style>

	<script src="//ajax.googleapis.com/ajax/libs/angularjs/1.2.16/angular.min.js"></script><!--angular-->

	<script src="js/controllers/main.js"></script> <!--controller-->
	<script src="js/services/catalogue.js"></script> <!--catalogue-->
	<script src="js/core.js"></script> <!--application-->

</head>

<!-- SET THE CONTROLLER -->
<body ng-controller="mainController">
	<div class="container is-three-quarters">

		<!-- HEADER AND MEME COUNT -->
		<section class="hero">
			<div class="hero-body">
					<div class="container">
					<h1 class="title">I understand <span class="icon has-text-info">{{ memes.length }}</span> memes</h1>
				</div>
			</div>
		</section>

		<!-- MEME LIST -->
		<div id="meme-list" class="row">
			<div class="col-sm-4 col-sm-offset-4">
				<div class="card" ng-repeat="meme in memes">
					<div class="card-image">
						<figure class="image is-square">
							<img src="https://bulma.io/images/placeholders/256x256.png" alt="Placeholder image">
						</figure>
					</div>
					<div class="card-content">
						<div class="media">
							<div class="media-left">
								<figure class="image is-48x48">
									<img src="https://bulma.io/images/placeholders/96x96.png" alt="Placeholder image">
								</figure>
							</div>
							<div class="media-content">
								<p class="title is-4">{{ meme.origin }}</p>
							</div>
						</div>

						<div class="content">
							{{ meme.analysis }}

							<span class="tag" ng-repeat="tag in memes.tags"> {{tag}} </span>
							<br>
							<time>{{ meme.date }}</time>
						</div>
					</div>
				</div>

				<p class="text-center" ng-show="loading">
					<span class="fa fa-spinner fa-spin fa-3x"></span>
				</p>

			</div>
		</div>

		<!-- FORM TO CREATE MEMES -->
		<div class="box form-group">
			<form>
				<article class="media">
					<div class="media-left">
						<div class="file is-boxed is-primary">
							<label class="file-label">
								<input class="file-input" type="file" name="image" disabled="">
								<span class="file-cta">
									<span class="file-icon">
										<span class="fas fa-cloud-upload-alt fa-2x"></span>
									</span>
									<span class="file-label">
										Choose a fileâ€¦ [disabled]
									</span>
								</span>
							</label>
						</div>
					</div>
					<div class="media-content">
						<div class="content">

							<template id="form-input">
								<div class="field">
									<p class="control has-icons-left">
										<label class="label" slot="label"><slot name="label">Label</slot></label>
										<slot name="input"></slot>
										<span class="icon is-large is-left">
											<slot name="icon"></slot>
										</span>
									</p>
								</div>
							</template>

							<!-- VALUE BOUND TO formData IN ANGULAR -->
							<form-input>
								<span slot="label">Origin</span>
								<input type="text" class="input" id="origin_input" slot="input" ng-model="formData.origin" placeholder="author via site">
								<i class="fas fa-at" slot="icon"></i>
							</form-input>

							<p class="control has-icons-left">
								<label class="label">Date</label>
								<input type="date" id="date_input" ng-model="formData.date" class="input is-info">
								<span class="icon is-small is-left">
									<i class="fas fa-calendar-alt"></i>
								</span>
							</p>

							<p class="control has-icons-left">
								<label class="label">Tags</label>
								<input type="text" id="tag_input" ng-model="formData.tags" class="input is-info" placeholder="Tags (text post, panel, analysis, loss, twitter, political)">
								<span class="icon is-small is-left">
									<i class="fas fa-tags"></i>
								</span>
							</p>

							<p class="control has-icons-left">
								<label class="label">Analysis</label>
								<input type="text" id="analysis_input" ng-model="formData.analysis" class="input is-info" placeholder="Analysis and Commentary">
								<span class="icon is-small is-left">
									<i class="fas fa-object-group"></i>
								</span>
							</p>
						</div>
					</div>
				</article>
				<div class="control">
					<button type="submit" class="button is-primary" ng-click="createMeme()">Add</button>
				</div>
			</form>
		</div>
	</div>

	<script type="text/javascript">
		window.onload = function(){
			define_elements();
			document.getElementById('date_input').valueAsDate = new Date();
			preload();
		}

		preload = function() {
			document.getElementById('origin_input').value = "@spooky.miller via Instagram";
			document.getElementById('tag_input').value = "juul, fortnite, selfie";
			document.getElementById('analysis_input').value = "The combination of both the infamous Juul and the Fortnite '#1 Victory Royale' make for a doubly cringy image (This is the image I'm talking about https://www.instagram.com/p/Bk6ab4cn_hfO7PPZi4NHOBg2-8h2NHCoTgH_W00)";
		}

		define_elements = function(){
			customElements.define('form-input',
				class extends HTMLElement {
					constructor() {
						super();
						let template = document.getElementById('form-input');
						let templateContent = template.content;

						const shadowRoot = this.attachShadow({mode: 'open'})
							.appendChild(templateContent.cloneNode(true));
				}
			})
		}
	</script>
</body>
</html>
